<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peel Potato ST_GZWCM - 帮助文档</title>
    <style>
        body {
            font-family: "Microsoft YaHei", "Segoe UI", Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1 {
            color: #d35400;
            border-bottom: 3px solid #d35400;
            padding-bottom: 10px;
        }
        h2 {
            color: #e67e22;
            margin-top: 30px;
            border-left: 4px solid #e67e22;
            padding-left: 10px;
        }
        h3 {
            color: #555;
            margin-top: 20px;
        }
        .feature-box {
            background: white;
            border: 2px solid #e67e22;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 15px 0;
        }
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 12px;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #e67e22;
            color: white;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
        }
        .file-structure {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            font-family: "Consolas", "Monaco", monospace;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>🥔 Peel Potato ST_GZWCM 使用帮助</h1>
    
    <div class="info">
        <strong>ST_GZWCM 版本说明：</strong>此版本为广州网管项目定制，增加了 AutoSum（员工筛选）和 AutoSLC（列选择）功能。
    </div>

    <h2>📋 功能概览</h2>

    <div class="feature-box">
        <h3>🔹 AutoSum - 员工筛选</h3>
        <p>根据员工列表文件，从当前活动工作表中筛选指定员工的数据，并创建新工作表。</p>
        <p><strong>适用场景：</strong>从大量员工数据中快速筛选出特定组或特定人员的记录。</p>
    </div>

    <div class="feature-box">
        <h3>🔹 AutoSLC - 列选择与重命名</h3>
        <p>根据字典文件，从当前活动工作表中选择指定列并重命名，创建新的精简工作表。</p>
        <p><strong>适用场景：</strong>从复杂数据表中提取关键列，统一列名规范。</p>
    </div>

    <h2>📁 文件结构与配置</h2>

    <h3>1. 项目文件布局</h3>
    <div class="file-structure">
Peel Potato/
├── peel_potato(st_gzwcm).py    # ST_GZWCM 主程序
├── st_gzwcm_autosum.py         # AutoSum 功能模块
├── st_gzwcm_autoslc.py         # AutoSLC 功能模块
│
├── emp.xlsx                    # 用户员工列表（可自定义）
├── dict.xlsx                   # 用户字典文件（可自定义）
│
├── data/                       # 数据文件夹
│   ├── emp_embbed.xlsx         # 内置员工列表（备用）
│   └── dict_embbed.xlsx        # 内置字典文件（备用）
│
└── media/                      # 媒体资源文件夹
    ├── help_st_gzwcm.html      # 本帮助文件
    └── ...
    </div>

    <div class="warning">
        <strong>⚠️ 重要说明：</strong>
        <ul>
            <li><code>emp.xlsx</code> 和 <code>dict.xlsx</code> 放在项目根目录，与 .py 或 .exe 文件同级</li>
            <li><code>emp_embbed.xlsx</code> 和 <code>dict_embbed.xlsx</code> 放在 <code>data/</code> 文件夹中</li>
            <li>程序会优先使用根目录的用户文件，找不到时才使用 data/ 中的备用文件</li>
        </ul>
    </div>

    <h3>2. emp.xlsx 文件结构</h3>
    <p><strong>工作表名称：</strong><code>emp</code></p>
    <table>
        <thead>
            <tr>
                <th>列名</th>
                <th>说明</th>
                <th>示例</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>emp</code></td>
                <td>员工姓名</td>
                <td>张三、李四、王五</td>
            </tr>
            <tr>
                <td><code>grp</code></td>
                <td>所属组别</td>
                <td>第1组、第2组</td>
            </tr>
        </tbody>
    </table>

    <p><strong>示例数据：</strong></p>
    <table>
        <thead>
            <tr>
                <th>emp</th>
                <th>grp</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>邝勇江</td>
                <td>第1组</td>
            </tr>
            <tr>
                <td>汪礼君</td>
                <td>第1组</td>
            </tr>
            <tr>
                <td>覃俊嘉</td>
                <td>第1组</td>
            </tr>
            <tr>
                <td>李东明</td>
                <td>第2组</td>
            </tr>
        </tbody>
    </table>

    <h3>3. dict.xlsx 文件结构</h3>
    <p><strong>工作表名称：</strong><code>dict</code></p>
    <table>
        <thead>
            <tr>
                <th>列名</th>
                <th>说明</th>
                <th>示例</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>old</code></td>
                <td>原列名（当前工作表中的列名）</td>
                <td>日期、员工编号、员工名称</td>
            </tr>
            <tr>
                <td><code>new</code></td>
                <td>新列名（重命名后的列名，为空则不选择该列）</td>
                <td>统计日期、工号、姓名</td>
            </tr>
        </tbody>
    </table>

    <p><strong>示例数据：</strong></p>
    <table>
        <thead>
            <tr>
                <th>old</th>
                <th>new</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>日期</td>
                <td>统计日期</td>
            </tr>
            <tr>
                <td>员工编号</td>
                <td>工号</td>
            </tr>
            <tr>
                <td>员工名称</td>
                <td>姓名</td>
            </tr>
            <tr>
                <td>所属机构</td>
                <td></td>
            </tr>
        </tbody>
    </table>

    <div class="info">
        <strong>💡 提示：</strong>如果 <code>new</code> 列为空，该列将不会被选择。在上例中，"所属机构" 列会被忽略。
    </div>

    <h2>🚀 使用步骤</h2>

    <h3>AutoSum 使用流程</h3>
    <ol>
        <li><strong>准备员工列表：</strong>确保 <code>emp.xlsx</code> 文件存在，包含 <code>emp</code> 工作表，有 <code>emp</code> 和 <code>grp</code> 两列</li>
        <li><strong>打开数据文件：</strong>在 Excel 中打开需要筛选的员工数据表</li>
        <li><strong>确认列名：</strong>数据表必须包含以下任一列名（不区分大小写）：
            <ul>
                <li><code>emp</code> / <code>employee</code> / <code>name</code></li>
                <li><code>员工</code> / <code>姓名</code></li>
            </ul>
        </li>
        <li><strong>点击 AutoSum 按钮：</strong>程序会自动筛选 emp.xlsx 中列出的员工</li>
        <li><strong>查看结果：</strong>生成新工作表，命名为 <code>原表名_filtered</code></li>
    </ol>

    <h3>AutoSLC 使用流程</h3>
    <ol>
        <li><strong>准备字典文件：</strong>确保 <code>dict.xlsx</code> 文件存在，包含 <code>dict</code> 工作表，有 <code>old</code> 和 <code>new</code> 两列</li>
        <li><strong>打开数据文件：</strong>在 Excel 中打开需要提取列的数据表</li>
        <li><strong>配置字典：</strong>在 <code>dict.xlsx</code> 中指定需要的列和新列名</li>
        <li><strong>点击 AutoSLC 按钮：</strong>程序会自动选择并重命名列</li>
        <li><strong>查看结果：</strong>生成新工作表，命名为 <code>原表名_slc</code></li>
    </ol>

    <h2>⚠️ 常见问题</h2>

    <div class="feature-box">
        <h3>❌ 错误：找不到员工列表文件</h3>
        <p><strong>原因：</strong><code>emp.xlsx</code> 和 <code>data/emp_embbed.xlsx</code> 都不存在</p>
        <p><strong>解决：</strong>将 <code>emp.xlsx</code> 放在程序根目录，或确保 <code>data/emp_embbed.xlsx</code> 存在</p>
    </div>

    <div class="feature-box">
        <h3>❌ 错误：找不到员工列</h3>
        <p><strong>原因：</strong>当前活动工作表中没有符合要求的员工列名</p>
        <p><strong>解决：</strong>确保数据表包含以下任一列名：<code>emp</code>、<code>employee</code>、<code>name</code>、<code>员工</code>、<code>姓名</code></p>
    </div>

    <div class="feature-box">
        <h3>❌ 错误：无匹配员工</h3>
        <p><strong>原因：</strong>emp.xlsx 中列出的员工在当前工作表中不存在</p>
        <p><strong>解决：</strong>检查员工姓名是否完全匹配（包括空格、大小写）</p>
    </div>

    <div class="feature-box">
        <h3>❌ 错误：无匹配列</h3>
        <p><strong>原因：</strong>dict.xlsx 中指定的列在当前工作表中不存在</p>
        <p><strong>解决：</strong>检查 <code>old</code> 列中的列名是否与数据表完全匹配</p>
    </div>

    <h2>📝 注意事项</h2>
    <ul>
        <li>运行 AutoSum/AutoSLC 前，确保在 Excel 中激活了正确的工作表（不要激活配置文件）</li>
        <li>生成的新工作表会自动覆盖同名工作表</li>
        <li>列名匹配支持不区分大小写</li>
        <li>修改 <code>emp.xlsx</code> 或 <code>dict.xlsx</code> 后无需重启程序</li>
        <li>打包为 .exe 后，用户文件仍应放在与 .exe 同级目录</li>
    </ul>

    <h2>🎯 快速参考</h2>
    <table>
        <thead>
            <tr>
                <th>文件</th>
                <th>位置</th>
                <th>工作表名</th>
                <th>必需列</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>emp.xlsx</td>
                <td>项目根目录</td>
                <td>emp</td>
                <td>emp, grp</td>
            </tr>
            <tr>
                <td>dict.xlsx</td>
                <td>项目根目录</td>
                <td>dict</td>
                <td>old, new</td>
            </tr>
            <tr>
                <td>emp_embbed.xlsx</td>
                <td>data/ 文件夹</td>
                <td>emp</td>
                <td>emp, grp</td>
            </tr>
            <tr>
                <td>dict_embbed.xlsx</td>
                <td>data/ 文件夹</td>
                <td>dict</td>
                <td>old, new</td>
            </tr>
        </tbody>
    </table>

    <hr style="margin: 30px 0; border: none; border-top: 2px solid #ddd;">
    <p style="text-align: center; color: #999;">
        Peel Potato ST_GZWCM v3.2 | FastBI for Excel | 广州网管定制版
    </p>
</body>
</html>
